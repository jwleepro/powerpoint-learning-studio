# PPT Coach - Frontend Specification

## 1. 개요

### 1.1 목적
PowerPoint 위에 오버레이를 표시하고, 단계별 가이드 패널을 통해 사용자를 안내하는 클라이언트 애플리케이션 명세

### 1.2 기술 스택
| 구분 | 기술 |
|------|------|
| Framework | WPF (.NET 8) |
| Language | C# 12 |
| UI Pattern | MVVM |
| PowerPoint 연동 | COM Interop (Microsoft.Office.Interop.PowerPoint) |
| 오버레이 | WPF Transparent Window |

---

## 2. 화면 구성

### 2.1 화면 흐름도
> 화면 흐름도는 [05. ui_design.md](./05.%20ui_design.md) 참조

### 2.2 화면 목록

| ID | 화면명 | 설명 |
|----|--------|------|
| SCR-01 | 시작 화면 | 앱 로고, 시작 버튼, 최근 세션 |
| SCR-02 | 템플릿 선택 | 가이드 템플릿 목록 표시 |
| SCR-03 | 가이드 패널 | 단계별 안내, 진행 상태, 체크리스트 |
| SCR-04 | 오버레이 | PowerPoint 위 투명 레이어 |
| SCR-05 | 피드백 알림 | 실시간 검증 결과 표시 |
| SCR-06 | 최종 검토 | 전체 검증 결과 요약 |
| SCR-07 | 완료 화면 | 완료 축하, 저장 안내 |

---
## 3. 화면 상세
> 화면 상세는 [05. ui_design.md](./05.%20ui_design.md) 참조

---

## 4. 컴포넌트 구조

### 4.1 Window 계층
```
App
├── MainWindow (시작, 템플릿 선택)
├── GuidePanel (가이드 패널 - 별도 창)
├── OverlayWindow (오버레이 - Topmost 투명 창)
└── ToastWindow (알림 토스트)
```

### 4.2 ViewModel 구조
```
ViewModels/
├── MainViewModel.cs
├── TemplateSelectionViewModel.cs
├── GuideViewModel.cs
├── OverlayViewModel.cs
├── FeedbackViewModel.cs
└── ReviewViewModel.cs
```

### 4.3 주요 서비스
```
Services/
├── PowerPointService.cs      // COM Interop
├── OverlayService.cs         // 오버레이 제어
├── ValidationService.cs      // 실시간 검증
├── SessionService.cs         // 세션 관리
└── ApiService.cs             // 백엔드 통신
```

---

## 5. PowerPoint 연동

### 5.1 COM Interop 이벤트

| 이벤트 | 용도 |
|--------|------|
| SlideSelectionChanged | 슬라이드 변경 감지 |
| WindowSelectionChange | 요소 선택 감지 |
| AfterShapeSizeChange | 도형 크기 변경 감지 |
| PresentationSave | 저장 이벤트 감지 |

### 5.2 창 위치 동기화
```csharp
// PowerPoint 창 위치/크기 추적
Timer syncTimer = new Timer(16); // 60fps
syncTimer.Elapsed += (s, e) => {
    var pptRect = GetPowerPointWindowRect();
    OverlayWindow.SetPosition(pptRect);
};
```

---

## 6. 관련 요구사항 매핑

| 요구사항 ID | 화면/기능 |
|-------------|----------|
| FR-101~107 | PowerPointService |
| FR-201~202 | SCR-02 템플릿 선택 |
| FR-203~204 | SCR-03 가이드 패널 진행 상태 |
| FR-205~206 | SCR-03 단계 설명, 예시 보기 |
| FR-207 | SessionService |
| FR-301~307 | SCR-04 오버레이 |
| FR-401~407 | SCR-05 피드백 알림 |
| FR-408 | 피드백 알림 자동 수정 버튼 |
