# PPT Coach - TDD 구현 계획

## 테스트 주도 개발 계획

이 계획은 Kent Beck의 TDD 사이클을 따릅니다: Red → Green → Refactor. 각 테스트는 한 번에 하나씩 구현하고, 통과시킨 후, 다음 테스트로 넘어가기 전에 리팩토링해야 합니다.

---

## 1단계: PowerPoint COM Interop (FR-101 ~ FR-107)

### 1.1 PPT 인스턴스 연결

- [ ] 테스트: PowerPoint가 시스템에 설치되어 있는지 감지해야 함
- [ ] 테스트: PowerPoint가 실행 중이 아닐 때 null을 반환해야 함
- [ ] 테스트: 실행 중인 PowerPoint 인스턴스에 연결해야 함
- [ ] 테스트: 여러 PowerPoint 인스턴스를 처리해야 함
- [ ] 테스트: COM 연결 실패 시 예외를 던져야 함

### 1.2 새 문서 생성

- [ ] 테스트: 새로운 PowerPoint 프레젠테이션을 생성해야 함
- [ ] 테스트: 생성 후 프레젠테이션 객체를 반환해야 함
- [ ] 테스트: 기본 빈 슬라이드와 함께 프레젠테이션을 생성해야 함
- [ ] 테스트: 생성 실패를 정상적으로 처리해야 함

### 1.3 슬라이드 정보 읽기

- [ ] 테스트: 현재 슬라이드 번호를 가져와야 함
- [ ] 테스트: 슬라이드가 선택되지 않았을 때 0을 반환해야 함
- [ ] 테스트: 전체 슬라이드 개수를 가져와야 함
- [ ] 테스트: 슬라이드 제목 텍스트를 읽어야 함
- [ ] 테스트: 슬라이드의 모든 텍스트 내용을 읽어야 함
- [ ] 테스트: 슬라이드의 모든 도형을 가져와야 함
- [ ] 테스트: 도형 타입(텍스트, 이미지, 표 등)을 반환해야 함

### 1.4 슬라이드 조작

- [ ] 테스트: 새로운 빈 슬라이드를 추가해야 함
- [ ] 테스트: 특정 레이아웃의 슬라이드를 추가해야 함
- [ ] 테스트: 인덱스로 슬라이드를 삭제해야 함
- [ ] 테스트: 슬라이드를 한 위치에서 다른 위치로 이동해야 함
- [ ] 테스트: 슬라이드가 하나만 남았을 때 삭제를 방지해야 함

### 1.5 요소 속성 읽기

- [ ] 테스트: 텍스트 도형에서 글꼴 이름을 가져와야 함
- [ ] 테스트: 텍스트 도형에서 글꼴 크기를 가져와야 함
- [ ] 테스트: 텍스트 도형에서 글꼴 색상(RGB)을 가져와야 함
- [ ] 테스트: 도형의 채우기 색상을 가져와야 함
- [ ] 테스트: 도형의 위치(Left, Top)를 가져와야 함
- [ ] 테스트: 도형의 크기(Width, Height)를 가져와야 함
- [ ] 테스트: 표 셀 내용을 가져와야 함
- [ ] 테스트: 텍스트가 없는 도형을 정상적으로 처리해야 함

### 1.6 요소 속성 수정 (선택사항)

- [ ] 테스트: 텍스트 도형의 글꼴 이름을 변경해야 함
- [ ] 테스트: 텍스트 도형의 글꼴 크기를 변경해야 함
- [ ] 테스트: 텍스트 도형의 글꼴 색상을 변경해야 함
- [ ] 테스트: 도형의 채우기 색상을 변경해야 함
- [ ] 테스트: 도형을 새로운 위치로 이동해야 함
- [ ] 테스트: 도형의 크기를 조정해야 함

### 1.7 이벤트 감지

- [ ] 테스트: 슬라이드 변경 이벤트를 감지해야 함
- [ ] 테스트: 도형 선택 변경 이벤트를 감지해야 함
- [ ] 테스트: 프레젠테이션 저장 이벤트를 감지해야 함
- [ ] 테스트: 프레젠테이션 닫기 이벤트를 감지해야 함
- [ ] 테스트: 이벤트에서 올바르게 구독 해제해야 함

---

## 2단계: 단계별 가이드 시스템 (FR-201 ~ FR-207)

### 2.1 가이드 템플릿 관리

- [ ] 테스트: JSON 파일에서 가이드 템플릿을 로드해야 함
- [ ] 테스트: 여러 단계의 템플릿을 구문 분석해야 함
- [ ] 테스트: 템플릿 구조를 검증해야 함
- [ ] 테스트: 잘못된 템플릿 형식에 대해 오류를 반환해야 함
- [ ] 테스트: 사용 가능한 모든 템플릿을 나열해야 함
- [ ] 테스트: 이름으로 템플릿을 선택해야 함

### 2.2 단계 정의

- [ ] 테스트: 제목과 설명을 포함한 단계를 정의해야 함
- [ ] 테스트: 체크포인트 조건을 포함한 단계를 정의해야 함
- [ ] 테스트: 특정 슬라이드 번호에 단계를 할당해야 함
- [ ] 테스트: 단계에 필요한 작업을 정의해야 함
- [ ] 테스트: 단계의 검증 규칙을 정의해야 함

### 2.3 진행 상태 표시

- [ ] 테스트: 현재 단계 번호를 계산해야 함
- [ ] 테스트: 전체 단계 개수를 계산해야 함
- [ ] 테스트: 진행률(%)을 계산해야 함
- [ ] 테스트: 단계를 완료로 표시해야 함
- [ ] 테스트: 단계를 진행 중으로 표시해야 함
- [ ] 테스트: 모든 완료된 단계를 나열해야 함
- [ ] 테스트: 모든 대기 중인 단계를 나열해야 함

### 2.4 단계 네비게이션

- [ ] 테스트: 다음 단계로 이동해야 함
- [ ] 테스트: 이전 단계로 이동해야 함
- [ ] 테스트: 인덱스로 특정 단계로 점프해야 함
- [ ] 테스트: 현재 단계가 완료되지 않았을 때 다음으로 이동하는 것을 방지해야 함
- [ ] 테스트: 확인 후 단계를 건너뛸 수 있어야 함
- [ ] 테스트: 첫 번째 단계로 돌아가기(재시작)가 가능해야 함

### 2.5 단계 설명

- [ ] 테스트: 현재 단계의 텍스트 설명을 가져와야 함
- [ ] 테스트: 단계 삽화의 이미지 경로를 가져와야 함
- [ ] 테스트: 마크다운을 사용하여 설명을 포매팅해야 함
- [ ] 테스트: 상세한 지시사항 목록을 제공해야 함

### 2.6 예시 표시

- [ ] 테스트: 단계의 예시 이미지를 로드해야 함
- [ ] 테스트: 예시 프레젠테이션 파일 경로를 제공해야 함
- [ ] 테스트: 이전/이후 비교를 표시해야 함
- [ ] 테스트: 누락된 예시를 정상적으로 처리해야 함

### 2.7 진행 상태 지속

- [ ] 테스트: 진행 상태를 파일로 저장해야 함
- [ ] 테스트: 파일에서 진행 상태를 로드해야 함
- [ ] 테스트: 재시작 시 가이드 상태를 복원해야 함
- [ ] 테스트: 손상된 진행 상태 파일을 처리해야 함
- [ ] 테스트: 새 가이드를 시작할 때 진행 상태를 초기화해야 함

---

## 3단계: 오버레이 강조 시스템 (FR-301 ~ FR-307)

### 3.1 오버레이 윈도우

- [ ] 테스트: 투명한 오버레이 윈도우를 생성해야 함
- [ ] 테스트: PowerPoint 윈도우 위에 오버레이를 배치해야 함
- [ ] 테스트: 오버레이를 항상 맨 위에 표시해야 함
- [ ] 테스트: 여러 모니터를 처리해야 함
- [ ] 테스트: PowerPoint가 최소화되었을 때 오버레이를 숨겨야 함

### 3.2 영역 강조

- [ ] 테스트: 좌표에서 직사각형 강조를 그려야 함
- [ ] 테스트: 빨간색 테두리로 강조를 그려야 함
- [ ] 테스트: 반투명 채우기로 강조를 그려야 함
- [ ] 테스트: 리본 메뉴 버튼을 강조해야 함
- [ ] 테스트: 특정 슬라이드 영역을 강조해야 함
- [ ] 테스트: 새로운 강조를 그리기 전에 이전 강조를 지워야 함

### 3.3 화살표/포인터

- [ ] 테스트: 대상 위치를 가리키는 화살표를 그려야 함
- [ ] 테스트: 화살표 방향을 자동으로 계산해야 함
- [ ] 테스트: 애니메이션 효과와 함께 화살표를 그려야 함
- [ ] 테스트: 사용자 클릭 시 화살표를 숨겨야 함

### 3.4 도구 팁/말풍선

- [ ] 테스트: 강조 근처에 텍스트 도구 팁을 표시해야 함
- [ ] 테스트: 도구 팁을 화면 가장자리를 피하도록 배치해야 함
- [ ] 테스트: 텍스트 길이에 따라 도구 팁의 크기를 자동으로 조정해야 함
- [ ] 테스트: 읽기 쉬운 글꼴로 도구 팁을 스타일링해야 함

### 3.5 윈도우 위치 동기화

- [ ] 테스트: PowerPoint 윈도우 위치를 추적해야 함
- [ ] 테스트: PPT 윈도우가 이동할 때 오버레이를 업데이트해야 함
- [ ] 테스트: PPT 윈도우 크기가 변경될 때 오버레이를 업데이트해야 함
- [ ] 테스트: PPT 윈도우 최소화/복원을 처리해야 함
- [ ] 테스트: 60 FPS 이상으로 동기화해야 함

### 3.6 클릭 통과

- [ ] 테스트: 강조되지 않은 영역에서 클릭을 통과시켜야 함
- [ ] 테스트: 마우스 이벤트를 PowerPoint로 전달해야 함
- [ ] 테스트: 강조된 영역의 클릭을 감지해야 함
- [ ] 테스트: PowerPoint로의 키보드 입력을 차단하지 않아야 함

### 3.7 애니메이션 효과 (선택사항)

- [ ] 테스트: 강조 테두리를 펄스해야 함
- [ ] 테스트: 화살표 움직임을 애니메이션 처리해야 함
- [ ] 테스트: 도구 팁을 페이드 인/아웃해야 함
- [ ] 테스트: 사용자 상호작용 시 애니메이션을 중지해야 함

---

## 4단계: 실시간 검증 및 피드백 (FR-401 ~ FR-408)

### 4.1 글꼴 일관성 확인

- [ ] 테스트: 프레젠테이션에서 사용된 모든 글꼴 이름을 감지해야 함
- [ ] 테스트: 고유한 글꼴 이름을 세어야 함
- [ ] 테스트: 일관성이 없는 글꼴 사용을 플래그해야 함
- [ ] 테스트: 사용된 모든 글꼴 크기를 감지해야 함
- [ ] 테스트: 너무 많은 다양한 글꼴 크기를 플래그해야 함
- [ ] 테스트: 문서의 표준 글꼴을 제안해야 함

### 4.2 색상 일관성 확인

- [ ] 테스트: 도형에서 사용된 모든 색상을 추출해야 함
- [ ] 테스트: 고유한 색상을 세어야 함
- [ ] 테스트: 3가지 이상의 색상이 사용되었을 때 플래그해야 함
- [ ] 테스트: 흰색/검은색을 색상 개수에서 제외해야 함
- [ ] 테스트: 색상 팔레트를 제안해야 함

### 4.3 레이아웃 확인

- [ ] 테스트: 제목 위치 일관성을 확인해야 함
- [ ] 테스트: 여백 일관성을 확인해야 함
- [ ] 테스트: 텍스트 정렬 일관성을 확인해야 함
- [ ] 테스트: 잘못 정렬된 요소를 플래그해야 함
- [ ] 테스트: 레이아웃 수정을 제안해야 함

### 4.4 슬라이드 구조 확인

- [ ] 테스트: 제목 슬라이드가 존재하는지 확인해야 함
- [ ] 테스트: 의제/목차가 존재하는지 확인해야 함
- [ ] 테스트: 필수 섹션이 존재하는지 확인해야 함
- [ ] 테스트: 슬라이드 순서를 확인해야 함
- [ ] 테스트: 누락된 필수 슬라이드를 플래그해야 함

### 4.5 콘텐츠 확인

- [ ] 테스트: 빈 슬라이드를 감지해야 함
- [ ] 테스트: 대체되지 않은 자리 표시자 텍스트를 감지해야 함
- [ ] 테스트: 제목이 없는 슬라이드를 감지해야 함
- [ ] 테스트: 지나치게 긴 텍스트(6개 이상의 글머리 기호)를 감지해야 함
- [ ] 테스트: 누락된 콘텐츠를 플래그해야 함

### 4.6 실시간 알림

- [ ] 테스트: 문제가 감지되면 즉시 알려야 함
- [ ] 테스트: 오버레이에서 알림을 표시해야 함
- [ ] 테스트: 가이드 패널에서 알림을 표시해야 함
- [ ] 테스트: 여러 알림을 큐에 넣어야 함
- [ ] 테스트: 알림을 해제할 수 있어야 함

### 4.7 수정 제안

- [ ] 테스트: 구체적인 수정 텍스트를 제공해야 함
- [ ] 테스트: 이전/이후 미리보기를 표시해야 함
- [ ] 테스트: 제안을 심각도별로 우선순위 지정해야 함
- [ ] 테스트: 제안을 관련 단계와 연결해야 함

### 4.8 자동 수정 (선택사항)

- [ ] 테스트: 승인 시 글꼴 일관성을 수정해야 함
- [ ] 테스트: 승인 시 색상 일관성을 수정해야 함
- [ ] 테스트: 승인 시 정렬을 수정해야 함
- [ ] 테스트: 적용 전에 사용자 확인이 필요해야 함
- [ ] 테스트: 자동 수정 후 실행 취소를 지원해야 함

---

## 5단계: 통합 및 엔드투엔드 테스트

### 5.1 전체 사용자 워크플로우

- [ ] 테스트: 처음부터 끝까지 전체 가이드를 완료해야 함
- [ ] 테스트: 가이드 중단 및 재개를 처리해야 함
- [ ] 테스트: 진행 상태를 올바르게 저장 및 복원해야 함
- [ ] 테스트: 완료된 프레젠테이션이 모든 확인을 통과하는지 검증해야 함

### 5.2 오류 처리

- [ ] 테스트: PowerPoint 충돌을 정상적으로 처리해야 함
- [ ] 테스트: 가이드 중 사용자가 PowerPoint를 닫는 것을 처리해야 함
- [ ] 테스트: 네트워크/파일 액세스 오류를 처리해야 함
- [ ] 테스트: 의미 있는 오류 메시지를 제공해야 함

### 5.3 성능

- [ ] 테스트: 오버레이 업데이트를 16ms 이내에 렌더링해야 함
- [ ] 테스트: PowerPoint 작업을 차단하지 않아야 함
- [ ] 테스트: 메모리를 100MB 미만으로 사용해야 함
- [ ] 테스트: 대규모 프레젠테이션(50개 이상의 슬라이드)을 처리해야 함

### 5.4 호환성

- [ ] 테스트: PowerPoint 2016에서 작동해야 함
- [ ] 테스트: PowerPoint 2019에서 작동해야 함
- [ ] 테스트: PowerPoint 2021에서 작동해야 함
- [ ] 테스트: 지원하지 않는 PowerPoint 버전을 감지해야 함

---

## 참고사항

- 테스트 완료 시 [x]로 표시하기
- 한 번에 하나의 테스트만 작성하기
- 최소한의 코드로 통과시키기
- Green 상태에서만 리팩토링하기
- 구조적 변경과 동작 변경을 별도로 커밋하기
- 커밋 전에 모든 테스트 실행하기
